<div class="chat-container">
  <div class="chat-header">
    <button class="back-btn" (click)="goBack()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M19 12H5"/>
            <path d="M12 19l-7-7 7-7"/>
        </svg>
    </button>
    <div class="contact-info">
      <img src="assets/icon/emestudiosCamiseta.jpeg" alt="Avatar" class="avatar">
      <div class="contact-details">
        <h3>Camiseta EMEstudios</h3>
        <p>Altruista</p>
      </div>
    </div>
    <div class="header-actions">
      <span class="badge">PrÃ©stamo</span>
      <button class="menu-btn">â‹®</button>
    </div>
  </div>

  <div class="messages-area" #messagesContainer>
    <button class="date-button">Ayer</button>

    <div class="message received">
      <p>Â¡Hola! Vi tu camiseta de EMEstudios ğŸ‘• Me encanta, Â¿podrÃ­as prestaramela para este finde?</p>
      <span class="timestamp">18:19</span>
    </div>

    <div class="message sent">
      <p>Â¡Hey! SÃ­ claro, sin problema</p>
      <span class="timestamp">18:19</span>
      <i class="check-icon">âœ“âœ“</i>
    </div>

    <div class="message sent">
      <p>Solo te pido que me la devuelvas limpia para el domingo.</p>
      <span class="timestamp">18:19</span>
      <i class="check-icon">âœ“âœ“</i>
    </div>

    <div class="message received">
      <p>De una, tranqui ğŸ‘</p>
      <span class="timestamp">18:19</span>
    </div>

    <div class="message received">
      <p>Â¿Te viene bien que la recoja el viernes por la tarde?</p>
      <span class="timestamp">18:19</span>
    </div>

    <div class="message sent">
      <p>SÃ­, perfecto. Te pongo los datos para que lo confirmemos</p>
      <span class="timestamp">18:19</span>
      <i class="check-icon">âœ“âœ“</i>
    </div>
  </div>

  <div class="action-buttons" *ngIf="!showConfiguration">
    <button class="config-btn" (click)="toggleConfiguration()">Configurar quedada</button>
  </div>

  <div class="config-panel" *ngIf="showConfiguration">
    <div class="config-options">
      <button class="config-option" (click)="openLocationPicker()">
        <i class="icon">ğŸ“</i>
        <span>Lugar</span>
        <span class="value" *ngIf="meetup.location">{{ meetup.location }}</span>
      </button>

      <button class="config-option" (click)="openDatePicker()">
        <i class="icon">ğŸ“…</i>
        <span>DÃ­a</span>
        <span class="value" *ngIf="meetup.date">{{ meetup.date | date: 'short' }}</span>
      </button>

      <button class="config-option" (click)="openTimePicker()">
        <i class="icon">ğŸ•</i>
        <span>Hora</span>
        <span class="value" *ngIf="meetup.time">{{ meetup.time }}</span>
      </button>
    </div>
  </div>

  <div class="modal" *ngIf="showLocationModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h2>Seleccionar lugar</h2>
      <div class="map-container">
        <input type="text" placeholder="Buscar El Cerro Del Aguila" class="search-input">
        <div class="map-placeholder">
          <p>Mapa de ubicaciÃ³n</p>
        </div>
      </div>
      <div class="modal-buttons">
        <button class="btn-cancel" (click)="closeModal()">Cancelar</button>
        <button class="btn-confirm" (click)="confirmLocation()">Confirmar</button>
      </div>
    </div>
  </div>

  <div class="modal" *ngIf="showDateModal" (click)="closeModal()">
    <div class="modal-content date-modal" (click)="$event.stopPropagation()">
      <h2>Seleccionar fecha</h2>
      <div class="date-display">
        <span>{{ selectedDate | date: 'EEE, MMM d' }}</span>
        <button class="edit-btn">âœï¸</button>
      </div>
      <div class="calendar">
        <div class="calendar-header">
          <button>â†</button>
          <span>{{ selectedDate | date: 'MMMM yyyy' }}</span>
          <button>â†’</button>
        </div>
        <div class="calendar-grid">
          <div *ngFor="let day of calendarDays" 
               class="calendar-day"
               [class.selected]="day === selectedDate.getDate()"
               (click)="selectDate(day)">
            {{ day }}
          </div>
        </div>
      </div>
      <div class="modal-buttons">
        <button class="btn-cancel" (click)="closeModal()">Cancelar</button>
        <button class="btn-confirm" (click)="confirmDate()">OK</button>
      </div>
    </div>
  </div>

  <div class="modal" *ngIf="showTimeModal" (click)="closeModal()">
    <div class="modal-content time-modal" (click)="$event.stopPropagation()">
      <h2>Seleccionar hora</h2>
      <div class="time-display">
        <span class="time-value">{{ formattedSelectedHour }} : {{ formattedSelectedMinute }}</span>
        <div class="ampm-toggle">
          <button [class.active]="selectedPeriod === 'AM'" (click)="selectedPeriod = 'AM'">AM</button>
          <button [class.active]="selectedPeriod === 'PM'" (click)="selectedPeriod = 'PM'">PM</button>
        </div>
      </div>
      <div class="time-picker-grid">
        <div class="time-column">
          <span *ngFor="let h of [11,10,9,8]" 
                class="time-item"
                (click)="selectedHour = h">{{ h }}</span>
          <span class="time-item active" *ngFor="let h of [selectedHour]">{{ h }}</span>
          <span *ngFor="let h of [1,2,3,4]" 
                class="time-item"
                (click)="selectedHour = h">{{ h }}</span>
        </div>
        <span class="time-separator">:</span>
        <div class="time-column">
          <span *ngFor="let m of minuteValues" 
                class="time-item"
                [class.active]="m === selectedMinute"
                (click)="selectMinute(m)">
            {{ ('' + m).padStart(2, '0') }}
          </span>
        </div>
      </div>
      <div class="modal-buttons">
        <button class="btn-cancel" (click)="closeModal()">Cancelar</button>
        <button class="btn-confirm" (click)="confirmTime()">OK</button>
      </div>
    </div>
  </div>

</div>

<app-navegation-bar></app-navegation-bar>